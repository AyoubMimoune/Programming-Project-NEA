Public Class Form3
    Dim x As Integer
    Dim z As Integer
    Dim value As Integer = CInt(Math.Floor((3 - 1 + 1) * Rnd())) + 1
    Private Sub Form3_Load(sender As Object, e As EventArgs) Handles MyBase.Load
    End Sub

    Private Sub TableLayoutPanel1_Paint(sender As Object, e As PaintEventArgs) Handles TableLayoutPanel1.Paint

    End Sub

    Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click
        Button1.BackColor = Color.Red
        Button1.Enabled = False
        If (42 - (Form2.y * Form2.TextBox1.Text)) = x Then
            MsgBox("You have reached the limit")
            Label1.Visible = False

        End If
    End Sub

    Private Sub Button2_Click(sender As Object, e As EventArgs) Handles Button2.Click
        Button2.BackColor = Color.Red
        Button2.Enabled = False
        If (42 - (Form2.y * Form2.TextBox1.Text)) = x Then
            MsgBox("You have reached the limit")
            Label1.Visible = False

        End If
    End Sub

    Private Sub Button3_Click(sender As Object, e As EventArgs) Handles Button3.Click
        Button3.BackColor = Color.Red
        Button3.Enabled = False
        If (42 - (Form2.y * Form2.TextBox1.Text)) = x Then
            MsgBox("You have reached the limit")
            Label1.Visible = False

        End If
    End Sub

    Private Sub Button4_Click(sender As Object, e As EventArgs) Handles Button4.Click
        Button4.BackColor = Color.Red
        Button4.Enabled = False
        If (42 - (Form2.y * Form2.TextBox1.Text)) = x Then
            MsgBox("You have reached the limit")
            Label1.Visible = False

        End If
    End Sub

    Private Sub Button5_Click(sender As Object, e As EventArgs) Handles Button5.Click
        Button5.BackColor = Color.Red
        Button5.Enabled = False
        If (42 - (Form2.y * Form2.TextBox1.Text)) = x Then
            MsgBox("You have reached the limit")
            Label1.Visible = False

        End If
    End Sub

    Private Sub Button6_Click(sender As Object, e As EventArgs) Handles Button6.Click
        Button6.BackColor = Color.Red
        Button6.Enabled = False
        If (42 - (Form2.y * Form2.TextBox1.Text)) = x Then
            MsgBox("You have reached the limit")
            Label1.Visible = False

        End If
    End Sub

    Private Sub Button7_Click(sender As Object, e As EventArgs) Handles Button7.Click
        Button7.BackColor = Color.Red
        Button7.Enabled = False
        If (42 - (Form2.y * Form2.TextBox1.Text)) = x Then
            MsgBox("You have reached the limit")
            Label1.Visible = False

        End If
    End Sub

    Private Sub Button8_Click(sender As Object, e As EventArgs) Handles Button8.Click
        Button8.BackColor = Color.Red
        Button8.Enabled = False
        If (42 - (Form2.y * Form2.TextBox1.Text)) = x Then
            MsgBox("You have reached the limit")
            Label1.Visible = False

        End If
    End Sub

    Private Sub Button9_Click(sender As Object, e As EventArgs) Handles Button9.Click
        Button9.BackColor = Color.Red
        Button9.Enabled = False
        x = x + 1
        If (42 - (Form2.y * Form2.TextBox1.Text)) = x Then
            MsgBox("You have reached the limit")
            Label1.Visible = False

        End If
    End Sub

    Private Sub Button10_Click(sender As Object, e As EventArgs) Handles Button10.Click
        Button10.BackColor = Color.Red
        Button10.Enabled = False
        If (42 - (Form2.y * Form2.TextBox1.Text)) = x Then
            MsgBox("You have reached the limit")
            Label1.Visible = False

        End If
    End Sub

    Private Sub Button11_Click(sender As Object, e As EventArgs) Handles Button11.Click
        Button11.BackColor = Color.Red
        Button11.Enabled = False
        If (42 - (Form2.y * Form2.TextBox1.Text)) = x Then
            MsgBox("You have reached the limit")
            Label1.Visible = False

        End If
    End Sub

    Private Sub Button12_Click(sender As Object, e As EventArgs) Handles Button12.Click
        Button12.BackColor = Color.Red
        Button12.Enabled = False
        If (42 - (Form2.y * Form2.TextBox1.Text)) = x Then
            MsgBox("You have reached the limit")
            Label1.Visible = False

        End If
    End Sub

    Private Sub Button13_Click(sender As Object, e As EventArgs) Handles Button13.Click
        Button13.BackColor = Color.Red
        Button13.Enabled = False
        If (42 - (Form2.y * Form2.TextBox1.Text)) = x Then
            MsgBox("You have reached the limit")
            Label1.Visible = False

        End If
    End Sub

    Private Sub Button14_Click(sender As Object, e As EventArgs) Handles Button14.Click
        Button14.BackColor = Color.Red
        Button14.Enabled = False
        If (42 - (Form2.y * Form2.TextBox1.Text)) = x Then
            MsgBox("You have reached the limit")
            Label1.Visible = False

        End If
    End Sub

    Private Sub Button21_Click(sender As Object, e As EventArgs) Handles Button21.Click
        Button21.BackColor = Color.Red
        Button21.Enabled = False
        If (42 - (Form2.y * Form2.TextBox1.Text)) = x Then
            MsgBox("You have reached the limit")
            Label1.Visible = False

        End If
    End Sub

    Private Sub Button20_Click(sender As Object, e As EventArgs) Handles Button20.Click
        Button20.BackColor = Color.Red
        Button20.Enabled = False
        If (42 - (Form2.y * Form2.TextBox1.Text)) = x Then
            MsgBox("You have reached the limit")
            Label1.Visible = False

        End If
    End Sub

    Private Sub Button19_Click(sender As Object, e As EventArgs) Handles Button19.Click
        Button19.BackColor = Color.Red
        Button19.Enabled = False
        x = x + 1
        If (42 - (Form2.y * Form2.TextBox1.Text)) = x Then
            MsgBox("You have reached the limit")
            Label1.Visible = False

        End If
    End Sub

    Private Sub Button18_Click(sender As Object, e As EventArgs) Handles Button18.Click
        Button18.BackColor = Color.Red
        Button18.Enabled = False
        If (42 - (Form2.y * Form2.TextBox1.Text)) = x Then
            MsgBox("You have reached the limit")
            Label1.Visible = False

        End If
    End Sub

    Private Sub Button17_Click(sender As Object, e As EventArgs) Handles Button17.Click
        Button17.BackColor = Color.Red
        Button17.Enabled = False
        If (42 - (Form2.y * Form2.TextBox1.Text)) = x Then
            MsgBox("You have reached the limit")
            Label1.Visible = False

        End If
    End Sub

    Private Sub Button16_Click(sender As Object, e As EventArgs) Handles Button16.Click
        Button16.BackColor = Color.Red
        Button16.Enabled = False
        If (42 - (Form2.y * Form2.TextBox1.Text)) = x Then
            MsgBox("You have reached the limit")
            Label1.Visible = False

        End If
    End Sub

    Private Sub Button15_Click(sender As Object, e As EventArgs) Handles Button15.Click
        Button15.BackColor = Color.Red
        Button15.Enabled = False
        If (42 - (Form2.y * Form2.TextBox1.Text)) = x Then
            MsgBox("You have reached the limit")
            Label1.Visible = False

        End If
    End Sub

    Private Sub Button22_Click(sender As Object, e As EventArgs) Handles Button22.Click
        Button22.BackColor = Color.Red
        Button22.Enabled = False
        If (42 - (Form2.y * Form2.TextBox1.Text)) = x Then
            MsgBox("You have reached the limit")
            Label1.Visible = False

        End If
    End Sub

    Private Sub Button29_Click(sender As Object, e As EventArgs) Handles Button29.Click
        Button29.BackColor = Color.Red
        Button29.Enabled = False
        If (42 - (Form2.y * Form2.TextBox1.Text)) = x Then
            MsgBox("You have reached the limit")
            Label1.Visible = False

        End If
    End Sub

    Private Sub Button30_Click(sender As Object, e As EventArgs) Handles Button30.Click
        Button30.BackColor = Color.Red
        Button30.Enabled = False
        x = x + 1
        If (42 - (Form2.y * Form2.TextBox1.Text)) = x Then
            MsgBox("You have reached the limit")
            Label1.Visible = False

        End If
    End Sub

    Private Sub Button23_Click(sender As Object, e As EventArgs) Handles Button23.Click
        Button23.BackColor = Color.Red
        Button23.Enabled = False
        If (42 - (Form2.y * Form2.TextBox1.Text)) = x Then
            MsgBox("You have reached the limit")
            Label1.Visible = False

        End If
    End Sub

    Private Sub Button24_Click(sender As Object, e As EventArgs) Handles Button24.Click
        Button24.BackColor = Color.Red
        Button24.Enabled = False
        If (42 - (Form2.y * Form2.TextBox1.Text)) = x Then
            MsgBox("You have reached the limit")
            Label1.Visible = False

        End If
    End Sub

    Private Sub Button31_Click(sender As Object, e As EventArgs) Handles Button31.Click
        Button31.BackColor = Color.Red
        Button31.Enabled = False
        If (42 - (Form2.y * Form2.TextBox1.Text)) = x Then
            MsgBox("You have reached the limit")
            Label1.Visible = False

        End If
    End Sub

    Private Sub Button32_Click(sender As Object, e As EventArgs) Handles Button32.Click
        Button32.BackColor = Color.Red
        Button32.Enabled = False
        If (42 - (Form2.y * Form2.TextBox1.Text)) = x Then
            MsgBox("You have reached the limit")
            Label1.Visible = False

        End If
    End Sub

    Private Sub Button25_Click(sender As Object, e As EventArgs) Handles Button25.Click
        Button25.BackColor = Color.Red
        Button25.Enabled = False
        If (42 - (Form2.y * Form2.TextBox1.Text)) = x Then
            MsgBox("You have reached the limit")
            Label1.Visible = False

        End If
    End Sub

    Private Sub Button26_Click(sender As Object, e As EventArgs) Handles Button26.Click
        Button26.BackColor = Color.Red
        Button26.Enabled = False
        If (42 - (Form2.y * Form2.TextBox1.Text)) = x Then
            MsgBox("You have reached the limit")
            Label1.Visible = False

        End If
    End Sub

    Private Sub Button33_Click(sender As Object, e As EventArgs) Handles Button33.Click
        Button33.BackColor = Color.Red
        Button33.Enabled = False

        If (42 - (Form2.y * Form2.TextBox1.Text)) = x Then
            MsgBox("You have reached the limit")
            Label1.Visible = False

        End If
    End Sub

    Private Sub Button34_Click(sender As Object, e As EventArgs) Handles Button34.Click
        Button34.BackColor = Color.Red
        Button34.Enabled = False
        If (42 - (Form2.y * Form2.TextBox1.Text)) = x Then
            MsgBox("You have reached the limit")
            Label1.Visible = False

        End If
    End Sub

    Private Sub Button27_Click(sender As Object, e As EventArgs) Handles Button27.Click
        Button27.BackColor = Color.Red
        Button27.Enabled = False

        If (42 - (Form2.y * Form2.TextBox1.Text)) = x Then
            MsgBox("You have reached the limit")
            Label1.Visible = False

        End If
    End Sub

    Private Sub Button28_Click(sender As Object, e As EventArgs) Handles Button28.Click
        Button28.BackColor = Color.Red
        Button28.Enabled = False
        If (42 - (Form2.y * Form2.TextBox1.Text)) = x Then
            MsgBox("You have reached the limit")
            Label1.Visible = False

        End If
    End Sub

    Private Sub Button35_Click(sender As Object, e As EventArgs) Handles Button35.Click
        Button35.BackColor = Color.Red
        Button35.Enabled = False
        If (42 - (Form2.y * Form2.TextBox1.Text)) = x Then
            MsgBox("You have reached the limit")
            Label1.Visible = False

        End If


    End Sub

    Private Sub TextBox12_TextChanged(sender As Object, e As EventArgs) Handles TextBox12.TextChanged

    End Sub

    Private Sub TextBox11_TextChanged(sender As Object, e As EventArgs) Handles TextBox11.TextChanged

    End Sub

    Private Sub TextBox10_TextChanged(sender As Object, e As EventArgs) Handles TextBox10.TextChanged

    End Sub

    Private Sub TextBox9_TextChanged(sender As Object, e As EventArgs) Handles TextBox9.TextChanged

    End Sub

    Private Sub TextBox8_TextChanged(sender As Object, e As EventArgs) Handles TextBox8.TextChanged

    End Sub

    Private Sub Button40_Click(sender As Object, e As EventArgs) Handles Button40.Click
        Button40.BackColor = Color.Red
        Button40.Enabled = False
        If (42 - (Form2.y * Form2.TextBox1.Text)) = x Then
            MsgBox("You have reached the limit")
            Label1.Visible = False

        End If
    End Sub

    Private Sub Button39_Click(sender As Object, e As EventArgs) Handles Button39.Click
        Button39.BackColor = Color.Red
        Button39.Enabled = False
        If (42 - (Form2.y * Form2.TextBox1.Text)) = x Then
            MsgBox("You have reached the limit")
            Label1.Visible = False

        End If
    End Sub

    Private Sub Button38_Click(sender As Object, e As EventArgs) Handles Button38.Click
        Button38.BackColor = Color.Red
        Button38.Enabled = False
        If (42 - (Form2.y * Form2.TextBox1.Text)) = x Then
            MsgBox("You have reached the limit")
            Label1.Visible = False
        End If
    End Sub

    Private Sub Button36_Click(sender As Object, e As EventArgs) Handles Button36.Click
        Button36.BackColor = Color.Red
        Button36.Enabled = False
        If (42 - (Form2.y * Form2.TextBox1.Text)) = x Then
            MsgBox("You have reached the limit")
            Label1.Visible = False

        End If
    End Sub

    Private Sub Button42_Click(sender As Object, e As EventArgs) Handles Button42.Click
        Button42.BackColor = Color.Red
        Button42.Enabled = False
        If (42 - (Form2.y * Form2.TextBox1.Text)) = x Then
            MsgBox("You have reached the limit")
            Label1.Visible = False

        End If
    End Sub

    Private Sub Button41_Click(sender As Object, e As EventArgs) Handles Button41.Click
        Button41.BackColor = Color.Red
        Button41.Enabled = False
        If (42 - (Form2.y * Form2.TextBox1.Text)) = x Then
            MsgBox("You have reached the limit")
            Label1.Visible = False

        End If
    End Sub

    Private Sub Button37_Click(sender As Object, e As EventArgs) Handles Button37.Click
        Button37.BackColor = Color.Red
        Button37.Enabled = False
        If (42 - (Form2.y * Form2.TextBox1.Text)) = x Then
            MsgBox("You have reached the limit")
            Label1.Visible = False
        End If
    End Sub

    Private Sub Button43_Click(sender As Object, e As EventArgs)
    End Sub

    Private Sub Button44_Click(sender As Object, e As EventArgs) Handles Button44.Click

        Dim buttons() As Button = {Button1, Button2, Button3, Button4, Button5, Button6, Button7, Button8, Button9, Button10, Button11, Button12, Button13, Button14, Button15, Button16, Button17, Button18,
        Button19, Button20, Button21, Button22, Button23, Button24, Button25, Button26, Button27, Button28, Button29, Button30, Button31, Button32, Button33, Button34, Button35, Button36, Button37, Button38, Button39, Button40, Button41, Button42, Button7, Button8, Button9}
        For i = 0 To 42
            buttons(i).ForeColor = Color.Black
            If buttons(i).BackColor = Color.Red Then
            Else
                Dim val As Integer = Int(Rnd() * 3) + 1
                buttons(i).Text = Form2.ListBox1.Items.Item(val)
            End If
        Next
        For i = 0 To 42
            buttons(i).ForeColor = Color.Black
            buttons(i).Enabled = False
        Next
        Button44.Visible = False
        Button43.Visible = True
        Label1.Visible = False

    End Sub

    Private Sub Button43_Click_1(sender As Object, e As EventArgs) Handles Button43.Click
        Dim frm = Form.ActiveForm
        Using bmp = New Bitmap(frm.Width, frm.Height)
            frm.DrawToBitmap(bmp, New Rectangle(0, 0, bmp.Width, bmp.Height))
            bmp.Save("C:\Users\A\Desktop\" + Form1.TextBox4.Text + ".png")
        End Using
    End Sub
End Class
